<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meet Swamiji | Chinmaya Mission</title>

  <!-- Tailwind & Axios -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <style>
    /* Hide Scrollbar */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  
    /* Timeline Styling */
    .timeline-dot {
      box-shadow: 0 0 0 4px white, 0 0 10px #2A0001;
      z-index: 10;
      flex-shrink: 0;
    }
  
    .timeline-line {
      background: #B2A8A0;
      height: 4px;
      position: absolute;
      top: 45px;
      left: 0;
      z-index: 0;
    }
  
    /* Card Styling */
    .card {
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
      border-radius: 0.75rem;
      overflow: hidden;
      background: white;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
  
    /* Timeline container */
    #timeline {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  width: 100%;
  justify-content: space-between;
  padding: 2rem 2.6rem; /* reduced padding */
  position: relative;
  box-sizing: border-box;
}

  
    /* Each timeline item — show 5 cards per row on desktop */
    #timeline > div {
  scroll-snap-align: center;
  flex-shrink: 0;
  width: calc(19% - 1.3rem); /* narrower so all 5 fit */
  margin: 0 1.3rem;
  z-index: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
}

  
    /* ✅ Responsive Adjustments */
    @media (max-width: 1280px) {
      #timeline > div {
        width: calc(25% - 2rem); /* 4 per view */
      }
    }
  
    @media (max-width: 1024px) {
      #timeline > div {
        width: calc(33.33% - 2rem); /* 3 per view */
      }
    }
  
    @media (max-width: 768px) {
      #timeline {
        padding: 1.5rem 1rem;
      }
  
      #timeline > div {
        width: 80%; /* 1 per view on mobile */
        margin: 0 1rem;
      }
  
      .card img {
        height: 220px;
        width: 100%;
        object-fit: cover;
        border-bottom: 1px solid #eee;
      }
  
      .timeline-dot {
        width: 1rem;
        height: 1rem;
        margin-bottom: 1rem;
      }
  
      .timeline-line {
        top: 50px;
      }
  
      #scrollLeft,
      #scrollRight {
        bottom: -3rem;
        top: auto;
        width: 2.5rem;
        height: 2.5rem;
      }
  
      #scrollLeft {
        left: 20%;
      }
  
      #scrollRight {
        right: 20%;
      }
  
      h2 {
        font-size: 1.4rem;
      }
    }
  
    @media (max-width: 480px) {
      #timeline > div {
        width: 90%;
        margin: 0 0.75rem;
      }
  
      .card img {
        height: 180px;
      }
  
      .card .p-3 {
        padding: 0.75rem;
      }
  
      h4 {
        font-size: 0.9rem;
      }
  
      .text-xs {
        font-size: 0.7rem;
      }
  
      .timeline-dot {
        margin-bottom: 0.75rem;
      }
    }
  </style>
  
  
  
</head>

<body class="bg-white text-[#0f254a] font-sans">
  <section class="py-16 w-full">
    <!-- Header -->
    <div class="text-center mb-10 px-6">
      <h2 class="text-3xl font-bold flex items-center justify-center gap-2 text-[#2A0001]">
        <span class="text-orange-500 text-2xl">✦</span>
        Meet Swamiji
        <span class="text-orange-500 text-2xl">✦</span>
      </h2>
      <p class="text-gray-600 mt-3 max-w-3xl mx-auto text-lg">
        Join Swami Swaroopananda for life-changing camps, meditation courses, and Vedanta talks held across various
        locations around the world.
      </p>
    </div>

    <!-- Timeline -->
    <div class="relative max-w-[1600px] mx-auto flex items-center justify-center w-full">
      <!-- Left Arrow -->
      <button id="scrollLeft"
        class="absolute left-2 lg:left-0 z-20 bg-white border border-orange-400 text-orange-500 w-8 h-8 rounded-full flex items-center justify-center shadow hover:bg-orange-50 transition">
        ←
      </button>

      <!-- Scrollable container -->
      <div id="timeline" class="no-scrollbar scroll-smooth">
        <!-- Timeline line -->
        <div class="timeline-line"></div>
      </div>

      <!-- Right Arrow -->
      <button id="scrollRight"
        class="absolute right-2 lg:right-0 z-20 bg-white border border-orange-400 text-orange-500 w-8 h-8 rounded-full flex items-center justify-center shadow hover:bg-orange-50 transition">
        →
      </button>
    </div>
  </section>

  <script type="module">
    const API_URL = "https://admin.chinmayamission.com/api/graphql";
  
    const query = `
    query ItineraryList($filter: GetItineraryFilterInput) {
      ItineraryList(filter: $filter) {
        docs {
          id
          image { url }
          itineraryType
          userType
          purpose
          venue
          center { name slug address1 address2 address3 pincode country state city locationPhoneNumber }
          fromDate
          toDate
          country
          state
          city
          address
          phoneNumber
          status
          slug
          updatedAt
          createdAt
          eventName {
            id
            image { url }
            title
          }
          fromTime
          toTime
          duration
          centerName { name slug address1 address2 address3 pincode country state city locationPhoneNumber }
          flyer { url }
          userName { id slug type title }
        }
      }
    }`;
  
    const variables = {
      filter: {
        userId: "67a469eeeaf7c8571bdf3db1",
        userType: "Swami",
        // endDate: "10/29/2026",
        // startDate: "10/29/2025",
      },
    };
  
    async function fetchItineraryData() {
      try {
        const res = await axios.post(
          API_URL,
          { query, variables },
          { headers: { "Content-Type": "application/json" } }
        );
  
        const data = res.data.data.ItineraryList.docs;
        const timeline = document.getElementById("timeline");
  
        if (!data?.length) {
          timeline.innerHTML =
            "<p class='text-gray-500 w-full text-center'>No upcoming events found.</p>";
          return;
        }
  
        // ✅ Sort by fromDate ascending
        data.sort((a, b) => new Date(a.fromDate) - new Date(b.fromDate));
  
        data.forEach((item) => {
          const title =
            item.eventName?.title || item.purpose || "Untitled Itinerary";
          const image =
            item.eventName?.image?.url ||
            item.flyer?.url ||
            item.image?.url ||
            "https://via.placeholder.com/400x250?text=No+Image";
          const flyer = item.flyer?.url;
          const fromDate = new Date(item.fromDate);
          const dateText = fromDate.toLocaleDateString("en-GB", {
            day: "numeric",
            month: "long",
            year: "numeric",
          });
  
          const center = item.centerName || item.center || {};
          const centerName = center.name || "";
          const addressLines = [
            center.address1,
            center.address2,
            center.address3,
            center.city,
            center.state,
            center.country,
            center.pincode,
          ].filter(Boolean);
          const phone = center.locationPhoneNumber || item.phoneNumber || "";
  
          const card = document.createElement("div");
          card.className = "flex flex-col items-center relative";
  
          card.innerHTML = `
            <div class="flex flex-col items-left mb-6">
              <div class="w-5 h-5 bg-[#2A0001] rounded-full timeline-dot"></div>
              <p class="mt-4 text-sm font-medium text-gray-700 text-center whitespace-nowrap">${dateText}</p>
            </div>
  
            <div class="card">
              <img src="${image}" alt="${title}" class="rounded-lg">
              <div class="p-3 flex flex-col justify-between flex-grow">
                <div>
                  <h4 class="font-semibold text-base mb-1 text-[#2A0001] leading-tight">${title}</h4>
                  ${
                    centerName
                      ? `<p class="text-xs text-[#B2A8A0] font-medium mb-1">${centerName}</p>`
                      : ""
                  }
                  ${
                    addressLines.length
                      ? `<p class="text-xs text-gray-600 leading-snug">${addressLines.join(
                          ", "
                        )}</p>`
                      : ""
                  }
                  ${
                    phone
                      ? `<p class="text-xs text-gray-600 mt-1">${Array.isArray(
                          phone
                        )
                          ? phone.join(", ")
                          : phone}</p>`
                      : ""
                  }
                </div>
                ${
                  flyer
                    ? `<a href="${flyer}" target="_blank" class="inline-block mt-2 text-[#2A0001] text-xs font-medium underline">View Flyer</a>`
                    : ""
                }
              </div>
            </div>
          `;
  
          timeline.appendChild(card);
        });
  
        const timelineLine = timeline.querySelector(".timeline-line");
        timelineLine.style.width = `${timeline.scrollWidth}px`;
  
        window.addEventListener("resize", () => {
          timelineLine.style.width = `${timeline.scrollWidth}px`;
        });
      } catch (err) {
        console.error("GraphQL fetch failed:", err);
        document.getElementById("timeline").innerHTML =
          "<p class='text-red-500 text-center'>❌ Failed to load events.</p>";
      }
    }
  
    const scrollContainer = document.getElementById("timeline");
    document.getElementById("scrollLeft").onclick = () =>
      scrollContainer.scrollBy({
        left: -window.innerWidth * 0.9,
        behavior: "smooth",
      });
    document.getElementById("scrollRight").onclick = () =>
      scrollContainer.scrollBy({
        left: window.innerWidth * 0.9,
        behavior: "smooth",
      });
  
    fetchItineraryData();
  </script>
  
  
</body>

</html>
